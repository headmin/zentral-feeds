{
  "name": "Osquery demo",
  "description": "Demonstrate some of the osquery functionalities and the integration with Zentral.",
  "id": "io.zentral.demo.osquery",
  "probes": {
    "distributed-101": {
      "model": "OsqueryDistributedQueryProbe",
      "name": "Simple distributed query",
      "description": "Gather some info from the enrolled osquery clients.",
      "body": {
        "distributed_query": "select * from osquery_info;"
      }
    },
    "fim-101": {
      "model": "OsqueryFIMProbe",
      "name": "Monitor the .ssh folders",
      "description": "File integrity monitoring of the .ssh folders with osquery.\nhttps://osquery.readthedocs.io/en/stable/deployment/file-integrity-monitoring/",
      "body": {
        "file_paths": [
          {
            "file_access": false,
            "file_path": "/home/%/.ssh/"
          },
          {
            "file_access": false,
            "file_path": "/Users/%/.ssh/"
          },
          {
            "file_access": false,
            "file_path": "/root/.ssh/"
          }
        ]
      }
    },
    "debug": {
      "model": "BaseProbe",
      "name": "Osqueryd clients logs",
      "description": "The status logs posted by the osqueryd clients",
      "body": {
        "filters": {
          "metadata": [
            {
              "event_types": [
                "osquery_status"
              ]
            }
          ]
        }
      }
    },
    "1password-security-settings": {
      "model": "OsqueryComplianceProbe",
      "name": "1Password security settings",
      "description": "Demo for application compliance check. Monitor 1Password settings for lock and pasteboard settings.",
      "body": {
        "preference_files": [
          {
            "description": "Agilebits recommended defaults",
            "interval": 3600,
            "keys": [
              {
                "key": "ClearPasteboardAfterTimeout",
                "value": "1"
              },
              {
                "key": "ConcealPasswords",
                "value": "1"
              },
              {
                "key": "LockOnIdle",
                "value": "1"
              },
              {
                "key": "LockOnScreenSaver",
                "value": "1"
              },
              {
                "key": "LockOnSleep",
                "value": "1"
              },
              {
                "key": "LockOnUserSwitch",
                "value": "1"
              },
              {
                "key": "LockTimeout",
                "max_value": 5
              },
              {
                "key": "PasteboardClearTimeout",
                "max_value": 90
              }
            ],
            "rel_path": "com.agilebits.onepassword4.plist",
            "type": "USERS"
          }
        ]
      }
    }
  }
}
